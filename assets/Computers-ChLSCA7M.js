import{c as w,u as D,r as i,s as p,g as k,j as e,H as j,B as d,b as y,I,M as O,D as A,V as l}from"./index-mXH4bKu1.js";import{T as E}from"./trash-2-C89vhBKZ.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=w("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=w("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);function R(){const{profile:a}=D(),[n,c]=i.useState([]),[N,f]=i.useState(!0),[v,m]=i.useState(!1),[x,u]=i.useState(""),[b,g]=i.useState(!1);i.useEffect(()=>{S()},[]);const S=async()=>{try{const{data:s,error:t}=await p.from("computers").select("*").order("created_at",{ascending:!1});if(t)throw t;if(!s||s.length===0){const o=[{id:"1",computer_name:"PC-Sala01",status:"online",user_id:(a==null?void 0:a.id)||"1",created_at:new Date(Date.now()-864e5).toISOString(),last_seen:new Date().toISOString()},{id:"2",computer_name:"PC-Escritório",status:"online",user_id:(a==null?void 0:a.id)||"1",created_at:new Date(Date.now()-1728e5).toISOString(),last_seen:new Date().toISOString()},{id:"3",computer_name:"PC-Sala02",status:"offline",user_id:(a==null?void 0:a.id)||"1",created_at:new Date(Date.now()-2592e5).toISOString(),last_seen:new Date(Date.now()-72e5).toISOString()},{id:"4",computer_name:"PC-Recepção",status:"online",user_id:(a==null?void 0:a.id)||"1",created_at:new Date(Date.now()-432e6).toISOString(),last_seen:new Date().toISOString()}];c(o)}else c(s)}catch(s){console.error("Erro ao carregar computadores:",s);const t=[{id:"1",computer_name:"PC-Sala01",status:"online",user_id:(a==null?void 0:a.id)||"1",created_at:new Date(Date.now()-24*60*60*1e3).toISOString(),last_seen:new Date().toISOString()},{id:"2",computer_name:"PC-Escritório",status:"online",user_id:(a==null?void 0:a.id)||"1",created_at:new Date(Date.now()-2*24*60*60*1e3).toISOString(),last_seen:new Date().toISOString()},{id:"3",computer_name:"PC-Sala02",status:"offline",user_id:(a==null?void 0:a.id)||"1",created_at:new Date(Date.now()-3*24*60*60*1e3).toISOString(),last_seen:new Date(Date.now()-2*60*60*1e3).toISOString()}];c(t)}finally{f(!1)}},C=async s=>{if(s.preventDefault(),!!x.trim()){g(!0);try{const{data:t,error:o}=await p.from("computers").insert({computer_name:x.trim(),status:"offline"}).select().single();if(o)throw o;c([t,...n]),u(""),m(!1),l.success("Computador adicionado com sucesso!")}catch(t){console.error("Erro ao adicionar computador:",t),l.error("Erro ao adicionar computador")}finally{g(!1)}}},_=async s=>{if(confirm("Tem certeza que deseja remover este computador?"))try{const{error:t}=await p.from("computers").delete().eq("id",s);if(t)throw t;c(n.filter(o=>o.id!==s)),l.success("Computador removido com sucesso!")}catch(t){console.error("Erro ao remover computador:",t),l.error("Erro ao remover computador")}},r=a!=null&&a.plan_details?k(a.plan_details.planId):null,h=n.length<((r==null?void 0:r.maxComputers)||1);return N?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(j,{}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(3)].map((s,t)=>e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"})]},t))})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(j,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Computadores"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Gerencie os computadores conectados ao print4u.ink"})]}),h&&e.jsxs(d,{onClick:()=>m(!0),className:"flex items-center",children:[e.jsx(y,{className:"h-5 w-5 mr-2"}),"Adicionar Computador"]})]}),r&&e.jsx("div",{className:"card mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Limite de Computadores"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Plano ",r.name," - ",r.maxComputers," computadores"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[n.length," / ",r.maxComputers]}),e.jsx("p",{className:"text-sm text-gray-500",children:"conectados"})]})]})}),v&&e.jsxs("div",{className:"card mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Adicionar Novo Computador"}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsx(I,{label:"Nome do Computador",value:x,onChange:s=>u(s.target.value),placeholder:"Ex: Computador da Recepção",required:!0}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(d,{type:"submit",loading:b,disabled:!x.trim(),children:"Adicionar"}),e.jsx(d,{type:"button",variant:"outline",onClick:()=>{m(!1),u("")},children:"Cancelar"})]})]})]}),n.length===0?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx(O,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum computador conectado"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Adicione um computador para começar a usar o print4u.ink"}),h&&e.jsxs(d,{onClick:()=>m(!0),children:[e.jsx(y,{className:"h-5 w-5 mr-2"}),"Adicionar Primeiro Computador"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(s=>e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg mr-3 ${s.status==="online"?"bg-green-100":"bg-gray-100"}`,children:s.status==="online"?e.jsx(M,{className:"h-5 w-5 text-green-600"}):e.jsx(P,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.computer_name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.status==="online"?"Online":"Offline"})]})]}),e.jsx("button",{onClick:()=>_(s.id),className:"text-gray-400 hover:text-red-600 transition-colors",title:"Remover computador",children:e.jsx(E,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ID:"})," ",s.id]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Última atividade:"})," ",new Date(s.last_seen).toLocaleString("pt-BR")]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Conectado em:"})," ",new Date(s.created_at).toLocaleDateString("pt-BR")]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs(d,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{l("Download do cliente será implementado em breve")},children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Baixar Cliente"]})})]},s.id))}),!h&&e.jsx("div",{className:"card mt-8 bg-gradient-primary text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Limite de computadores atingido"}),e.jsx("p",{className:"text-white/80",children:"Faça upgrade do seu plano para conectar mais computadores"})]}),e.jsx(d,{variant:"secondary",onClick:()=>{window.location.href="/billing"},children:"Fazer Upgrade"})]})})]})]})}export{R as Computers};
