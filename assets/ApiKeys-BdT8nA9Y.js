import{c as f,u as T,r,s as y,j as e,H as b,B as d,b as N,I as H,E as B,D as V,V as n,d as q}from"./index-BjbIvb-M.js";import{T as z}from"./trash-2-D09N5-82.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=f("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=f("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);function F(){const{profile:t}=T(),[o,i]=r.useState([]),[v,A]=r.useState(!0),[I,l]=r.useState(!1),[m,x]=r.useState(""),[S,g]=r.useState(!1),[k,u]=r.useState(!1),[h,p]=r.useState("");r.useEffect(()=>{_()},[]);const _=async()=>{try{const{data:s,error:a}=await y.from("api_keys").select("*").order("created_at",{ascending:!1});if(a)throw a;if(!s||s.length===0){const c=[{id:"1",name:"Cliente Desktop",key_hash:"a1b2c3d4e5f6...",user_id:(t==null?void 0:t.id)||"1",created_at:new Date(Date.now()-6048e5).toISOString(),updated_at:new Date(Date.now()-6048e5).toISOString()},{id:"2",name:"Integração Web",key_hash:"f6e5d4c3b2a1...",user_id:(t==null?void 0:t.id)||"1",created_at:new Date(Date.now()-2592e5).toISOString(),updated_at:new Date(Date.now()-2592e5).toISOString()},{id:"3",name:"App Mobile",key_hash:"9a8b7c6d5e4f...",user_id:(t==null?void 0:t.id)||"1",created_at:new Date(Date.now()-864e5).toISOString(),updated_at:new Date(Date.now()-864e5).toISOString()}];i(c)}else i(s)}catch(s){console.error("Erro ao carregar API keys:",s);const a=[{id:"1",name:"Cliente Desktop",key_hash:"a1b2c3d4e5f6...",user_id:(t==null?void 0:t.id)||"1",created_at:new Date(Date.now()-7*24*60*60*1e3).toISOString(),updated_at:new Date(Date.now()-7*24*60*60*1e3).toISOString()},{id:"2",name:"Integração Web",key_hash:"f6e5d4c3b2a1...",user_id:(t==null?void 0:t.id)||"1",created_at:new Date(Date.now()-3*24*60*60*1e3).toISOString(),updated_at:new Date(Date.now()-3*24*60*60*1e3).toISOString()}];i(a)}finally{A(!1)}},D=async s=>{if(s.preventDefault(),!!m.trim()){g(!0);try{const a=q(),c=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(a)),C=Array.from(new Uint8Array(c)).map(O=>O.toString(16).padStart(2,"0")).join(""),{data:E,error:j}=await y.from("api_keys").insert({name:m.trim(),key_hash:C}).select().single();if(j)throw j;i([E,...o]),x(""),l(!1),p(a),u(!0),n.success("API Key criada com sucesso!")}catch(a){console.error("Erro ao criar API key:",a),n.error("Erro ao criar API key")}finally{g(!1)}}},K=async s=>{if(confirm("Tem certeza que deseja remover esta API Key?"))try{const{error:a}=await y.from("api_keys").delete().eq("id",s);if(a)throw a;i(o.filter(c=>c.id!==s)),n.success("API Key removida com sucesso!")}catch(a){console.error("Erro ao remover API key:",a),n.error("Erro ao remover API key")}},P=s=>{navigator.clipboard.writeText(s),n.success("Copiado para a área de transferência!")};return v?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(b,{}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(3)].map((s,a)=>e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"})]},a))})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(b,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"API Keys"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Gerencie suas chaves de API para integração com clientes"})]}),e.jsxs(d,{onClick:()=>l(!0),className:"flex items-center",children:[e.jsx(N,{className:"h-5 w-5 mr-2"}),"Nova API Key"]})]}),I&&e.jsxs("div",{className:"card mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Criar Nova API Key"}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsx(H,{label:"Nome da API Key",value:m,onChange:s=>x(s.target.value),placeholder:"Ex: Cliente Desktop Principal",required:!0}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(d,{type:"submit",loading:S,disabled:!m.trim(),children:"Criar API Key"}),e.jsx(d,{type:"button",variant:"outline",onClick:()=>{l(!1),x("")},children:"Cancelar"})]})]})]}),k&&h&&e.jsx("div",{className:"card mb-8 bg-green-50 border-green-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-900 mb-2",children:"API Key Criada com Sucesso!"}),e.jsx("p",{className:"text-green-700 mb-4",children:"Guarde esta chave em um local seguro. Ela não será exibida novamente."}),e.jsx("div",{className:"bg-white p-3 rounded border border-green-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("code",{className:"text-sm font-mono text-gray-800 break-all",children:h}),e.jsx("button",{onClick:()=>P(h),className:"ml-2 text-green-600 hover:text-green-800",title:"Copiar",children:e.jsx(L,{className:"h-4 w-4"})})]})})]}),e.jsx("button",{onClick:()=>{u(!1),p("")},className:"text-green-600 hover:text-green-800",children:e.jsx(B,{className:"h-5 w-5"})})]})}),o.length===0?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx(w,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma API Key criada"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Crie uma API Key para começar a integrar com clientes desktop"}),e.jsxs(d,{onClick:()=>l(!0),children:[e.jsx(N,{className:"h-5 w-5 mr-2"}),"Criar Primeira API Key"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(s=>e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-primary-100 rounded-lg mr-3",children:e.jsx(w,{className:"h-5 w-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name||"API Key sem nome"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Criada em ",new Date(s.created_at).toLocaleDateString("pt-BR")]})]})]}),e.jsx("button",{onClick:()=>K(s.id),className:"text-gray-400 hover:text-red-600 transition-colors",title:"Remover API Key",children:e.jsx(z,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ID:"})," ",s.id]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Hash:"})," ",s.key_hash.substring(0,16),"..."]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 space-y-2",children:[e.jsxs(d,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{n("Download do cliente será implementado em breve")},children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Baixar Cliente"]}),e.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Use esta API Key no cliente desktop para conectar"})]})]},s.id))}),e.jsxs("div",{className:"card mt-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Como usar a API"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Endpoint de Impressão"}),e.jsx("div",{className:"bg-gray-100 p-3 rounded text-sm font-mono",children:"POST https://your-project.supabase.co/functions/v1/createPrintJob"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Headers"}),e.jsxs("div",{className:"bg-gray-100 p-3 rounded text-sm font-mono",children:["Authorization: Bearer YOUR_API_KEY",e.jsx("br",{}),"Content-Type: application/json"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Body"}),e.jsx("div",{className:"bg-gray-100 p-3 rounded text-sm font-mono",children:`{
  "file_content_base64": "base64_encoded_pdf",
  "printer_id": "printer_name",
  "title": "Document Title"
}`})]})]})]})]})]})}export{F as ApiKeys};
